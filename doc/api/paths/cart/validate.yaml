post:
  tags:
    - Cart
  summary: カート検証
  description: |
    カート内の商品の在庫状況、価格、プロモーション適用を検証します。
    注文確定前に実行することを推奨します。
  operationId: validateCart
  security:
    - bearerAuth: []
  responses:
    '200':
      description: カート検証成功
      content:
        application/json:
          schema:
            type: object
            properties:
              valid:
                type: boolean
                description: カートが有効か
                example: true
              issues:
                type: array
                description: 検証で発見された問題
                items:
                  type: object
                  properties:
                    type:
                      type: string
                      enum:
                        - OUT_OF_STOCK
                        - INSUFFICIENT_STOCK
                        - PRICE_CHANGED
                        - PRODUCT_UNAVAILABLE
                        - PROMOTION_EXPIRED
                      example: "INSUFFICIENT_STOCK"
                    skuId:
                      type: string
                      example: "SKU-JACKET-M-BLACK"
                    message:
                      type: string
                      example: "在庫が不足しています（要求: 5, 利用可能: 2）"
              cart:
                $ref: '../../components/schemas/cart.yaml#/Cart'
    '401':
      $ref: '../../components/responses/common.yaml#/Unauthorized'
    '500':
      $ref: '../../components/responses/common.yaml#/InternalServerError'
